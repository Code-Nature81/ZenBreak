<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ZenBreak - Accueil</title>

  <!-- Lien vers le manifest PWA -->
  <link rel="manifest" href="/ZenBreak/manifest.json">


  <!-- Couleur de la barre dâ€™Ã©tat (Android) -->
  <meta name="theme-color" content="#0277bd" />

  <!-- IcÃ´nes pour les diffÃ©rents usages -->
  <link rel="apple-touch-icon" sizes="180x180" href="logo.png" />
  <link rel="icon" type="image/png" sizes="32x32" href="logo.png" />
  <link rel="icon" type="image/png" sizes="16x16" href="logo.png" />

  <!-- Ton fichier CSS -->
  <link rel="stylesheet" href="style.css" />

  <script async src="https://www.googletagmanager.com/gtag/js?id=G-Q68DPGEDM4"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-Q68DPGEDM4');
</script>
</head>


<body>
  <!-- Infobulle d'installation -->
<div id="installPrompt" class="install-popup">
  <div class="popup-content">
    
    <h2 style="color: black;">ğŸ“² Installer ZenBreak</h2>
    <p style="color: black;">Pour une meilleure expÃ©rience, installe lâ€™application sur ton appareil.</p>
    <button id="installBtn" class="btn-install">Installer</button>
  </div>
</div>
  <!-- Infobulle iOS -->
  <div id="iosInstallInfo" class="install-popup" style="display:none;">
    <div class="popup-content">
     
      <h2 style="color: black;">ğŸ“± Ajouter Ã  lâ€™Ã©cran dâ€™accueil</h2>
      <p style="color: black;">Sur iPhone :</p>
      <ol>
        <li style="color: black;">Appuyez sur <strong>Partager</strong> (icÃ´ne carrÃ© + flÃ¨che)</li>
        <li style="color: black;">Puis sur <strong>Â« Sur lâ€™Ã©cran dâ€™accueil Â»</strong></li>
      </ol>
    </div>
  </div>

  <video id="background-video" autoplay loop muted poster="121805-724719819_tiny.mp4">
  <source src="121805-724719819_tiny.mp4" type="video/mp4">
</video>

  <div class="container">
    <img src="logo.png" alt="Logo ZenBreak" style="width:150px; margin-bottom: 20px;" />
    <h1>Bienvenue sur ZenBreak</h1>
    <p style="color: white;">ğŸ§˜â€â™‚ï¸ Une pause relaxante Ã  portÃ©e de clic</p>
    <a href="choix-duree.html"><button>Commencer une pause</button></a>
    
    
  
<footer>
    <p>&copy; 2025 ZenBreak | Tous droits rÃ©servÃ©s</p>
  </footer>
</body>

<script>
  let deferredPrompt;
  const installPrompt = document.getElementById('installPrompt');
  const installBtn = document.getElementById('installBtn');
  const closePopup = document.getElementById('closePopup');

  window.addEventListener('beforeinstallprompt', (e) => {
    e.preventDefault();
    deferredPrompt = e;
    installPrompt.style.display = 'flex';

    installBtn.addEventListener('click', () => {
      installPrompt.style.display = 'none';
      deferredPrompt.prompt();
      deferredPrompt.userChoice.then(choice => {
        if (choice.outcome === 'accepted') {
          console.log("âœ… Appli installÃ©e !");
        } else {
          console.log("âŒ Installation refusÃ©e");
        }
        deferredPrompt = null;
      });
    });

    closePopup.addEventListener('click', () => {
      installPrompt.style.display = 'none';
    });
  });
 // DÃ©tection iOS
    function isIos() {
      return /iphone|ipad|ipod/.test(window.navigator.userAgent.toLowerCase());
    }

    function isInStandaloneMode() {
      return ('standalone' in window.navigator) && window.navigator.standalone;
    }

    if (isIos() && !isInStandaloneMode()) {
      document.getElementById('iosInstallInfo').style.display = 'flex';
    }
  // Service worker
  if ('serviceWorker' in navigator) {
    window.addEventListener('load', () => {
      navigator.serviceWorker.register('service-worker.js')
        .then(() => console.log("âœ… Service Worker actif"))
        .catch(err => console.log("âŒ Service Worker erreur :", err));
    });
  }

  if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register('service-worker.js')
    .then(registration => {
      registration.onupdatefound = () => {
        const newWorker = registration.installing;

        newWorker.onstatechange = () => {
          if (newWorker.state === 'installed') {
            if (navigator.serviceWorker.controller) {
              // Une nouvelle version est disponible
              showUpdatePopup();
            }
          }
        };
      };
    });

  let refreshing;
  navigator.serviceWorker.addEventListener('controllerchange', () => {
    if (refreshing) return;
    window.location.reload();
    refreshing = true;
  });
}

function showUpdatePopup() {
  const popup = document.createElement('div');
  popup.id = "update-popup";
  popup.innerHTML = `
    <div class="popup-overlay">
      <div class="popup-content">
        <h2>ğŸ†• Mise Ã  jour disponible</h2>
        <p>Une nouvelle version de lâ€™application est disponible.</p>
        <button id="update-app-btn">Mettre Ã  jour</button>
      </div>
    </div>
  `;
  document.body.appendChild(popup);

  document.getElementById('update-app-btn').addEventListener('click', () => {
    navigator.serviceWorker.getRegistration().then(reg => {
      if (reg.waiting) {
        reg.waiting.postMessage('SKIP_WAITING');
      }
    });
  });
}
</script>




</html>